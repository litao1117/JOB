# CDN
`CDN`:全称是Content Delivery Network，即内容分发网络。

其目的就是通过在现有的Internet中增加一层新的网络架构，将网站的内容发布到最接近用户的网络“边缘"，使用户可以就近取得所需的内容，解决Internet网络拥挤的情况，提高用户访问网站的响应速度。从技术上全面解决由于网络带宽小、用户访问量大、网点分布不均等原因造成的用户访问网站响应速度慢的问题。

简单的说，内容发布网（CDN）是一个经策略性部署的整体系统，包括分布式存储、负载均衡、网络请求的重定向和内容管理4个要件，而内容管理和全局的网络流量管理是CDN的核心所在。通过用户就近性和服务器负载的判断，CDN确保内容以一种极为高效的方式为用户的请求提供服务。

### 原理

资源上传cdn之后，当用户访问cdn的资源地址之后会经历下面的步骤：

1. 首先经过本地的dns解析，请求cname指向的那台cdn专用的dns服务器。
2. dns服务器返回全局负载均衡的服务器ip给用户。
3. 用户请求全局负载均衡服务器，服务器根据ip返回所在区域的负载均衡服务器ip给用户。
4. 用户请求区域负载均衡服务器，负载均衡服务器根据用户ip选择距离近的，并且存在用户所需内容的，负载比较合适的一台缓存服务器ip给用户。当没有对应内容时，会去上一级缓存服务器去找，直到找到资源所在的源站服务器，并且缓存在缓存服务器中。用户下次再请求该资源就可以就近拿到缓存了。

> cdn的负载均衡和就近选择缓存都是根据用户的ip来的，服务器只能拿到local dns的ip，就是网络设置中设置的dns ip，如果这个设置的不合理，那么可能起不到加速的效果。可能就近找到的缓存服务器实际离得很远。
>
> 负载均衡：建立在现有的网络结构之上，它提供了一种廉价有效透明的方法扩展网络设备和服务器的带宽、增加吞吐量、加强网络数据处理能力、提高网络的灵活性和可用性。 其意思就是将负载进行平衡，分摊到多个操作单元上进行运行。
>
> 负载均衡实现方式：1.HTTP重定向负载均衡2.DNS3.反向代理

