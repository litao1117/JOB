# 移动开发技术简介
## 原生开发
原生应用程序是指某一个移动平台（比如iOS或安卓）所特有的应用，使用相应平台支持的开发工具和语言，并直接调用系统提供的SDK API。比如Android原生应用就是指使用Java或Kotlin语言直接调用Android SDK开发的应用程序；而iOS原生应用就是指通过Objective-C或Swift语言直接调用iOS SDK开发的应用程序。原生开发有以下主要优势：
* 可访问平台全部功能（GPS、摄像头）；
* 速度快、性能高、可以实现复杂动画及绘制，整体用户体验好；
主要缺点：
* 平台特定，开发成本高；不同平台必须维护不同代码，人力成本随之变大；
* 内容固定，动态化弱，大多数情况下，有新功能更新时只能发版；

互联网发展初期，业务场景不复杂，需求迭代也并不频繁，原生开发还可以应对，但是随着互联网的发展，传统的原生开发已经不能满足日益增长的业务需求了，面临这两个问题，动态化内容业务需求增大，原生应用更新需要发版、上架审核等等，这个周期有可能会很长。还有就是开发成本的问题了，原生开发一般都需要维护Android、iOS两个开发团队，版本迭代时，无论人力成本，还是测试成本都会变大。
针对这些问题，诞生了一些跨平台的动态化框架。
## 跨平台技术
* H5 + 原生
* javaScript开发 + 原生渲染（React Native、Weex）
* 自绘UI + 原生 (Qt for mobile、Flutter)
### H5 + 原生
这类框架主要原理就是将 App 中需要动态变动的内容通过HTML5来实现，通过原生的网页加载控件WebView （Android）或 WKWebView（iOS）来加载。这种方案中，H5 部分是可以随时改变而不用发版，动态化需求能满足；同时，由于 H5 代码只需要一次开发，就能同时在 Android 和 iOS 两个平台运行，这也可以减小开发成本，也就是说，H5 部分功能越多，开发成本就越小。我们称这种 H5 + 原生 的开发模式为混合开发 ，采用混合模式开发的App我们称之为混合应用或 HTMLybrid App ，如果一个应用的大多数功能都是 H5 实现的话，我们称其为 Web App 。
#### 混合开发
原生开发是可以访问平台全部功能的，但是H5是运行在WebView中，实际上WebView就是一个浏览器内核，其JavaScript还是运行在一个受限的沙箱环境中，对大多数系统的功能是没有访问权限的，这时候就需要利用原生去做了。

混合框架一般都会在原生代码中预先实现一些访问系统能力的 API ， 然后暴露给 WebView 以供 JavaScript 调用。

这个时候就需要一个通信的桥梁来连接WebView和原生API了，主要负责 JavaScript 与原生之间传递调用消息，而消息的传递必须遵守一个标准的协议，它规定了消息的格式与含义，我们把依赖于 WebView 的用于在 JavaScript 与原生之间通信并实现了某种消息传输协议的工具称之为 WebView JavaScript Bridge , 简称 JsBridge，它也是混合开发框架的核心。

    混合应用的优点是动态内容是 H5，Web 技术栈，社区及资源丰富，缺点是性能体验不佳，对于复杂用户界面或动画，WebView 有时会不堪重任。

### React Native、Weex
#### React Native
React Native 是 React 在原生移动应用平台的衍生产物

其主要的区别在于虚拟 DOM 映射的对象是什么。
* React中虚拟 DOM 最终会映射为浏览器 DOM 树
* RN 中虚拟 DOM会通过 JavaScriptCore 映射为原生控件。

JavaScriptCore 是一个JavaScript解释器，它在React Native中主要有两个作用：
* 为 JavaScript 提供运行环境。
* 是 JavaScript 与原生应用之间通信的桥梁，作用和 JsBridge 一样

而 RN 中将虚拟 DOM 映射为原生控件的过程主要分两步：
* 布局消息传递； 将虚拟 DOM 布局信息传递给原生；
* 原生根据布局信息通过对应的原生控件渲染；
#### Weex
Weex 是阿里巴巴于 2016 年发布的跨平台移动端开发框架，思想及原理和 React Native 类似，底层都是通过原生渲染的，不同是应用层开发语法 （即 DSL，Domain Specific Language）：Weex 支持 Vue 语法和 Rax 语法，Rax 的 DSL(Domain Specific Language) 语法是基于 React JSX 语法而创造，而 RN 的 DSL 是基于 React 的，不支持 Vue。

总结下来，JavaScript + 原生渲染的方法优点如下：

1. 采用Web开发技术栈，社区丰富，上手较快，开发成本低
2. 原生渲染，性能比H5有提高
3. 动态化较好

缺点： 

1. 渲染时需要JavaScript和原生之间通信，某些场景可能会卡顿
2. JS为脚本语言，执行时需解释执行，即JIT，及时编译，相对于一些编译型语言来说执行效率还有差距。
3. 需要自定义原生渲染组件时，开发维护成本较高

### 自绘UI + 原生（Qt,Flutter）
这种技术的思路是：通过在不同平台实现一个统一接口的渲染引擎来绘制UI，而不依赖系统原生控件，所以可以做到不同平台UI的一致性。

优点如下：

* 性能高；由于自绘引擎是直接调用系统API来绘制UI，所以性能和原生控件接近。
* 灵活、组件库易维护、UI外观保真度和一致性高；由于UI渲染不依赖原生控件，也就不需要根据不同平台的控件单独维护一套组件库，所以代码容易维护。由于组件库是同一套代码、同一个渲染引擎，所以在不同平台，组件显示外观可以做到高保真和高一致性；另外，由于不依赖原生控件，也就不会受原生布局系统的限制，这样布局系统会非常灵活。

不足：

* 动态性不足；为了保证UI绘制性能，自绘UI系统一般都会采用 AOT（预先编译） 模式编译其发布包，所以应用发布后，不能像 Hybrid 和 RN 那些使用 JavaScript（JIT）作为开发语言的框架那样动态下发代码。
* 应用开发效率低：Qt 使用 C++ 作为其开发语言，而编程效率是直接会影响 App 开发效率的，C++ 作为一门静态语言，在 UI 开发方面灵活性不及 JavaScript 这样的动态语言，另外，C++需要开发者手动去管理内存分配，没有 JavaScript 及Java中垃圾回收（GC）的机制。

